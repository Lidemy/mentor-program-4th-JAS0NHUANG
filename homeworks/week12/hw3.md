## 這週這種後端負責提供只輸出資料的 API，前端一律都用 Ajax 串接的寫法，跟之前透過 PHP 直接輸出內容的留言板有什麼不同？
（我私自把這題放到前面來寫，因為我覺得先把這題寫好可能可以更清楚的解釋 SPA 是什麼。）
這兩種寫法都可以得到相同的結果：一個網站（網路應用程式）。連外觀都可以做的一模一樣，但是它們卻有很多不同的地方，像是實作、開發方式、運作方式……等等。  

#### - 透過 PHP 直接輸出內容：
  - 運作方式：由 http/https 伺服器接收請求，處理 PHP 程式的部分，取得所需要的資料，最後將它們放入 HTML/CSS/JavaScript 的前端模型裡，所有內容都在伺服器端處理、組裝完成後才將完整的 HTML/CSS/JavaScript 檔案回傳給客戶端。也因為 HTML 檔（包含資料）是在伺服器上組裝完成才回傳給瀏覽器，所以每次載入新資料的時候都需要換頁。  
  另外，這種模式下前後端基本上是運作在同一個伺服器上的。  

  - 開發方式：前後端會需要比較緊密的合作，以前端為例，因為開發時顯示頁面的 php 檔必需要經過伺服器處理才能正常顯示，所以至少要會運行後端伺服器，可能還要對資料庫有一定的瞭解；而後端也難免要寫一些前端 HTML/CSS 才能把 template 寫好讓前端使用。

#### - 後端提供 API 前端 Ajax 串接：
  - 運作方式：同樣會有一個伺服器接收請求，但是後端只處理後端程式邏輯，取得所需資料後，直接以 json 或其它格式的資料回傳。前端只要串接 API、知道回傳的資料格式，就可以使用 Ajax 方法取得資料並將取得的資料用 JavaSCript 以動態方式載入頁面中。  
    因為使用的是 Ajax 方法與伺服器交換資料，所以不需換頁。  
    在這種情況下，前後端可以說是完全分離了，前端甚至可以打包起來，做成一個像是桌面應用程式的網頁，使用者下載之後可以直接在本地端運行。  

- 開發方式：後端只是專注在開發 API 提供格式化的資料，完全不需要管前端如何處理回傳的資料，前端也一樣不需要管後端到底是如何實作的，不必瞭解資料庫、不必懂後端語言，只要會串 API 讀懂回傳的資料，就能完成前端頁面的開發。  

## 請簡單解釋什麼是 Single Page Application
Single Page Application 中文可以翻譯為「單頁應用程式」，常常被簡寫為 SPA 但是口語上好像大家還是會講 Single Page Application，其實就是像上面所提到的以「後端提供 API 前端 Ajax 串接」實作的網路應用程式（網站），它的特點就是以 Ajax 方法串接 API 取得資料，在交換資料時不需要換頁，所以單一頁面就可以有完整的功能。  

與 Single Page Application 相對的通常被稱為 Multi-page Application 也就是比較傳統的網站架構（上一題透過 PHP 直接輸出內容的網站），因為每次交換資料時都要換頁，所以會被稱做「多頁應用程式」。  

兩者其實也不互斥，是可以並存的，可以在 SPA 架構下有 MPA 的分頁，也可以在 MPA 的分頁裡 實作 SPA 傳遞資料，或者像是為了解決 SEO 的問題，可以首頁使用 SSR(Server Side Rendering) 之後再以 SPA 接手。  

## SPA 的優缺點為何
優點：
  - 更好的使用者體驗：少了換頁的情況除了可以讓使用者在操作時感到更流暢之外，也可以在運行不一樣的服務時不會互相干擾，像是老師在文章裡所提到的影音服務，如果少了 SPA 機制的話（同時聽音樂、找音樂、瀏覽專輯資訊……等等）確實會讓使用者體驗大打折扣。
  - 資料傳輸更快速：因為每次都只傳遞「真正需要的資料」，不像傳統的方式每次換頁都要重新載入整個分頁，就算可以用 cache 的方法預存重復用到的網頁內容，但是相比 SPA 頁面單純的 JSON 資料交換，重整頁面所涉及的資料傳輸仍難免臃腫一點。
  - 前後端分離更明確：如同上面所提到的，對開發者來說更容易分工，而且因為雙方都不必依賴對方的技術，所以只要專心在自已所熟悉的技術上就好。對於使用者來說，因為前後端分離更明確，所以就算伺服器當機或是維護中，還是可以進行本地端可以處理的操作，像是開啟離線模式在本地編輯文章並且將草稿先存在 local storage 裡（或直接存成本機檔案），待伺服器上線時再將資料上傳。

缺點：
- SEO：因為內容資料都是動態生成的，所以網頁上都只是空的容器，有些爬蟲可能沒有辦法抓取 Ajax 載入資料後的頁面內容，雖然現在相關的爬蟲技術有些已經可以自動抓取頁面渲染之後的資料，但是相較傳統直接回傳完整頁面的網站來說還是多了一些不確定因素。  
- 歷史紀錄：原本瀏覽器內建的歷史紀錄功能會失效，必需要另外運用 history api 或是其它方式處理。  
- 第一次載入的速度：如果從伺服器抓取的資料比較多的話，第一次載入頁面的速度可能會比較慢。  
- 必需要使用 JavaScript：使用者必需要允許 JavaScript 運行才能夠使用網站。  
- 對客戶端電腦負擔較重：因為集合資料交給前端程式碼渲染成最終 HTML 頁面的工作是在客戶端電腦執行，所以如果沒有考慮到使用者的硬體設備或使用情境（開很多分頁、運行其它程式……）可能會造成某些使用者體驗不佳。
- 前端工作量增加：上面提到的一些缺點也是可以靠一些技術克服，但是會讓前端開發變的更複雜、工作量變的更大（可以想像要多處理這些事情會有更大的工作量，但是到底是大多少我真的沒有一個概念阿～～），但是在某些複雜的頁面上，SPA 其實也有「減少」工作量的優點，所以應該依照開發內容決定是否使用 SPA。

## 其它補充
在某篇文章裡看到 content-first approach，大意就像這個單詞講的：「內容優先」。  
我想除了增進使用者體驗之外，一個網站最重要的就是它的內容了，不論是服務的內容、影音、文字的內容、廣告內容……所以其實這些技術都應該是為內容服務的，也應該針對不一樣的內容選擇適合的技術，而不是被這些技術給侷限住了。

還有在下面附上關於 PWA（Progressive Web Application）的影片，感覺最近也很紅，好像也是一個不錯的解決方案，大概只看了前面幾分鐘，有了一點概念，但是實在是很多技術細節要學，所以就先擱著吧！以後有空再好好研究了。

資料來源：  
[前後端分離與 SPA](https://blog.techbridge.cc/2017/09/16/frontend-backend-mvc/)  
[Frontend Engineering－認識 Single Page Application（SPA）](https://www.jollen.org/blog/2014/09/single-page-application.html)  
[Single-page application vs. multiple-page application](https://medium.com/@NeotericEU/single-page-application-vs-multiple-page-application-2591588efe58)  
[Beyond single-page apps: alternative architectures for your PWA (Google I/O '18)](https://www.youtube.com/watch?v=X6yof_vIQnk)  
[Migrating Multi-page Web Applications to Single-page AJAX Interfaces](https://arxiv.org/abs/cs/0610094)